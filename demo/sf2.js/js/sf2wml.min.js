/** @license sf2.js 2013 - imaya The MIT License */(function() {'use strict';function m(c){throw c;}var p=void 0,u=!0,y=!1,I=this;function aa(c,a){var b=c.split("."),d=I;!(b[0]in d)&&d.execScript&&d.execScript("var "+b[0]);for(var f;b.length&&(f=b.shift());)!b.length&&a!==p?d[f]=a:d=d[f]?d[f]:d[f]={}};function ba(c,a,b){this.ctx=c;this.destination=a;this.instrument=b;this.channel=b.channel;this.key=b.key;this.buffer=b.sample;this.playbackRate=b.basePlaybackRate;this.sampleRate=b.sampleRate;this.volume=b.volume;this.panpot=b.panpot;this.pitchBend=b.pitchBend;this.pitchBendSensitivity=b.pitchBendSensitivity;this.modEnvToPitch=b.modEnvToPitch}
ba.prototype.noteOn=function(){for(var c=this.ctx,a=this.instrument,b=this.buffer,d,f,g,e,k,v=this.ctx.currentTime,r=v+a.attack,z=r+a.decay,x=a.loopStart/this.sampleRate,E=a.loopEnd/this.sampleRate,J=a.start/this.sampleRate,A=b=b.subarray(0,b.length+a.end),B,t,w,D;22050>this.sampleRate;){B=new Int16Array(2*A.length);t=D=0;for(w=A.length;t<w;++t)B[D++]=A[t],B[D++]=A[t];A=B;this.sampleRate*=2}b=A;d=this.audioBuffer=c.createBuffer(1,b.length,this.sampleRate);d.getChannelData(0).set(b);f=this.bufferSource=
c.createBufferSource();f.buffer=d;f.loop=u;f.loopStart=x;f.loopEnd=E;ma(this,this.pitchBend,u);g=this.panner=c.createPanner();e=this.gainOutput=c.createGainNode();k=e.gain;g.panningModel=0;g.setPosition(Math.sin(this.panpot*Math.PI/2),0,Math.cos(this.panpot*Math.PI/2));k.setValueAtTime(0,v);k.linearRampToValueAtTime(this.volume,r);k.linearRampToValueAtTime(this.volume*(1-a.sustain),z);this.bufferSource.playbackRate.linearRampToValueAtTime(this.playbackRate*Math.pow(Math.pow(2,1/12)*this.instrument.scaleTuning,
this.modEnvToPitch+this.pitchBendSensitivity*this.pitchBend/(0>this.pitchBend?8192:8191)),r);f.connect(g);g.connect(e);e.connect(this.destination);f.start(0,J)};
ba.prototype.noteOff=function(){var c=this.instrument,a=this.bufferSource,b=this.gainOutput,d=this.ctx.currentTime+c.release;this.audioBuffer&&(b.gain.cancelScheduledValues(0),b.gain.linearRampToValueAtTime(0,d),a.loop=y,a.stop(d),setTimeout(function(a){return function(){a.bufferSource.disconnect(0);a.panner.disconnect(0);a.gainOutput.disconnect(0)}}(this),1E3*c.release))};
function ma(c,a,b){c.bufferSource.playbackRate.cancelScheduledValues(0);c.bufferSource.playbackRate.value=c.playbackRate*Math.pow(Math.pow(2,1/12),((b?0:c.modEnvToPitch)+c.pitchBendSensitivity*a/(0>a?8192:8191))*c.instrument.scaleTuning)};function na(c,a){a=a||{};this.input=c;this.ip=a.index||0;this.length=a.length||c.length-this.ip;this.offset=this.ip;this.padding=a.padding!==p?a.padding:u;this.bigEndian=a.bigEndian!==p?a.bigEndian:y}function oa(c,a,b){this.type=c;this.size=a;this.offset=b}
na.prototype.parse=function(){var c=this.length+this.offset;for(this.chunkList=[];this.ip<c;){var a=this.input,b=this.ip,d=p;this.chunkList.push(new oa(String.fromCharCode(a[b++],a[b++],a[b++],a[b++]),d=this.bigEndian?(a[b++]<<24|a[b++]<<16|a[b++]<<8|a[b++])>>>0:(a[b++]|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0,b));b+=d;this.padding&&1===(b-this.offset&1)&&b++;this.ip=b}};function N(c,a){var b=c.chunkList[a];return b===p?null:b};function pa(c,a){a=a||{};this.input=c;this.parserOption=a.parserOption}
pa.prototype.parse=function(){var c=new na(this.input,this.parserOption),a;c.parse();1!==c.chunkList.length&&m(Error("wrong chunk length"));a=N(c,0);null===a&&m(Error("chunk not found"));var b,d=this.input,f=a.offset,g;"RIFF"!==a.type&&m(Error("invalid chunk type:"+a.type));g=String.fromCharCode(d[f++],d[f++],d[f++],d[f++]);"sfbk"!==g&&m(Error("invalid signature:"+g));b=new na(d,{index:f,length:a.size-4});b.parse();3!==b.chunkList.length&&m(Error("invalid sfbk structure"));var e=N(b,0),k=this.input,
v=e.offset,r;"LIST"!==e.type&&m(Error("invalid chunk type:"+e.type));r=String.fromCharCode(k[v++],k[v++],k[v++],k[v++]);"INFO"!==r&&m(Error("invalid signature:"+r));(new na(k,{index:v,length:e.size-4})).parse();var z=N(b,1),x,E=this.input,J=z.offset,A;"LIST"!==z.type&&m(Error("invalid chunk type:"+z.type));A=String.fromCharCode(E[J++],E[J++],E[J++],E[J++]);"sdta"!==A&&m(Error("invalid signature:"+A));x=new na(E,{index:J,length:z.size-4});x.parse();1!==x.chunkList.length&&m(Error("TODO"));this.samplingData=
N(x,0);var B=N(b,2),t,w=this.input,D=B.offset,C;"LIST"!==B.type&&m(Error("invalid chunk type:"+B.type));C=String.fromCharCode(w[D++],w[D++],w[D++],w[D++]);"pdta"!==C&&m(Error("invalid signature:"+C));t=new na(w,{index:D,length:B.size-4});t.parse();9!==t.chunkList.length&&m(Error("invalid pdta chunk"));var S=N(t,0),s=this.input,n=S.offset,ha=this.presetHeader=[],ia=S.offset+S.size;"phdr"!==S.type&&m(Error("invalid chunk type:"+S.type));for(;n<ia;)ha.push({presetName:String.fromCharCode.apply(null,
s.subarray(n,n+=20)),preset:s[n++]|s[n++]<<8,bank:s[n++]|s[n++]<<8,presetBagIndex:s[n++]|s[n++]<<8,library:(s[n++]|s[n++]<<8|s[n++]<<16|s[n++]<<24)>>>0,genre:(s[n++]|s[n++]<<8|s[n++]<<16|s[n++]<<24)>>>0,morphology:(s[n++]|s[n++]<<8|s[n++]<<16|s[n++]<<24)>>>0});var T=N(t,1),Z=this.input,F=T.offset,O=this.presetZone=[],ja=T.offset+T.size;"pbag"!==T.type&&m(Error("invalid chunk type:"+T.type));for(;F<ja;)O.push({presetGeneratorIndex:Z[F++]|Z[F++]<<8,presetModulatorIndex:Z[F++]|Z[F++]<<8});var ca=N(t,
2);"pmod"!==ca.type&&m(Error("invalid chunk type:"+ca.type));this.presetZoneModulator=wa(this,ca);var da=N(t,3);"pgen"!==da.type&&m(Error("invalid chunk type:"+da.type));this.presetZoneGenerator=xa(this,da);var P=N(t,4),G=this.input,Q=P.offset,H=this.instrument=[],ka=P.offset+P.size;"inst"!==P.type&&m(Error("invalid chunk type:"+P.type));for(;Q<ka;)H.push({instrumentName:String.fromCharCode.apply(null,G.subarray(Q,Q+=20)),instrumentBagIndex:G[Q++]|G[Q++]<<8});var U=N(t,5),$=this.input,K=U.offset,
ea=this.instrumentZone=[],R=U.offset+U.size;"ibag"!==U.type&&m(Error("invalid chunk type:"+U.type));for(;K<R;)ea.push({instrumentGeneratorIndex:$[K++]|$[K++]<<8,instrumentModulatorIndex:$[K++]|$[K++]<<8});var V=N(t,6);"imod"!==V.type&&m(Error("invalid chunk type:"+V.type));this.instrumentZoneModulator=wa(this,V);var W=N(t,7);"igen"!==W.type&&m(Error("invalid chunk type:"+W.type));this.instrumentZoneGenerator=xa(this,W);var L=N(t,8),l=this.input,h=L.offset,la=this.sampleHeader=[],fa=L.offset+L.size;
"shdr"!==L.type&&m(Error("invalid chunk type:"+L.type));for(;h<fa;)la.push({sampleName:String.fromCharCode.apply(null,l.subarray(h,h+=20)),start:(l[h++]<<0|l[h++]<<8|l[h++]<<16|l[h++]<<24)>>>0,end:(l[h++]<<0|l[h++]<<8|l[h++]<<16|l[h++]<<24)>>>0,startLoop:(l[h++]<<0|l[h++]<<8|l[h++]<<16|l[h++]<<24)>>>0,endLoop:(l[h++]<<0|l[h++]<<8|l[h++]<<16|l[h++]<<24)>>>0,sampleRate:(l[h++]<<0|l[h++]<<8|l[h++]<<16|l[h++]<<24)>>>0,originalPitch:l[h++],pitchCorrection:l[h++]<<24>>24,sampleLink:l[h++]|l[h++]<<8,sampleType:l[h++]|
l[h++]<<8})};function wa(c,a){for(var b=c.input,d=a.offset,f=a.offset+a.size,g,e,k=[];d<f;){d+=2;g=b[d++]|b[d++]<<8;e=ya[g];if(e===p)k.push({type:e,value:{code:g,amount:b[d]|b[d+1]<<8<<16>>16,lo:b[d++],hi:b[d++]}});else switch(e){case "keyRange":case "velRange":case "keynum":case "velocity":k.push({type:e,value:{lo:b[d++],hi:b[d++]}});break;default:k.push({type:e,value:{amount:b[d++]|b[d++]<<8<<16>>16}})}d+=2;d+=2}return k}
function xa(c,a){for(var b=c.input,d=a.offset,f=a.offset+a.size,g,e,k=[];d<f;)if(g=b[d++]|b[d++]<<8,e=ya[g],e===p)k.push({type:e,value:{code:g,amount:b[d]|b[d+1]<<8<<16>>16,lo:b[d++],hi:b[d++]}});else switch(e){case "keynum":case "keyRange":case "velRange":case "velocity":k.push({type:e,value:{lo:b[d++],hi:b[d++]}});break;default:k.push({type:e,value:{amount:b[d++]|b[d++]<<8<<16>>16}})}return k}
function za(c,a,b){var d=[],f={unknown:[]},g,e;for(e=c;e<a;++e)g=b[e],d.push(g),"unknown"===g.type?f.unknown.push(g.value):f[g.type]=g.value;return{modgen:f,modgenInfo:d}}
var ya=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",,"chorusEffectsSend","reverbEffectsSend","pan",,,,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay",
"delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",,"scaleTuning","exclusiveClass","overridingRootKey"];function Aa(c){this.input=c;this.bank=0;this.bufferSize=1024;var a;I.AudioContext!==p?a=new I.AudioContext:I.webkitAudioContext!==p?a=new I.webkitAudioContext:I.mozAudioContext!==p?a=new I.mozAudioContext:m(Error("Web Audio not supported"));a.createGainNode===p&&(a.createGainNode=a.createGain);this.ctx=a;this.gainMaster=this.ctx.createGainNode();this.compressor=this.ctx.createDynamicsCompressor();this.bufSrc=this.ctx.createBufferSource();this.channelInstrument=[0,1,2,3,4,5,6,7,8,0,10,11,12,13,14,
15];this.channelVolume=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];this.channelPanpot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.channelPitchBend=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.channelPitchBendSensitivity=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.currentNoteOn=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];this.baseVolume=1/32768;this.masterVolume=16384}var Ba="Acoustic Piano;Bright Piano;Electric Grand Piano;Honky-tonk Piano;Electric Piano;Electric Piano 2;Harpsichord;Clavi;Celesta;Glockenspiel;Musical box;Vibraphone;Marimba;Xylophone;Tubular Bell;Dulcimer;Drawbar Organ;Percussive Organ;Rock Organ;Church organ;Reed organ;Accordion;Harmonica;Tango Accordion;Acoustic Guitar (nylon);Acoustic Guitar (steel);Electric Guitar (jazz);Electric Guitar (clean);Electric Guitar (muted);Overdriven Guitar;Distortion Guitar;Guitar harmonics;Acoustic Bass;Electric Bass (finger);Electric Bass (pick);Fretless Bass;Slap Bass 1;Slap Bass 2;Synth Bass 1;Synth Bass 2;Violin;Viola;Cello;Double bass;Tremolo Strings;Pizzicato Strings;Orchestral Harp;Timpani;String Ensemble 1;String Ensemble 2;Synth Strings 1;Synth Strings 2;Voice Aahs;Voice Oohs;Synth Voice;Orchestra Hit;Trumpet;Trombone;Tuba;Muted Trumpet;French horn;Brass Section;Synth Brass 1;Synth Brass 2;Soprano Sax;Alto Sax;Tenor Sax;Baritone Sax;Oboe;English Horn;Bassoon;Clarinet;Piccolo;Flute;Recorder;Pan Flute;Blown Bottle;Shakuhachi;Whistle;Ocarina;Lead 1 (square);Lead 2 (sawtooth);Lead 3 (calliope);Lead 4 (chiff);Lead 5 (charang);Lead 6 (voice);Lead 7 (fifths);Lead 8 (bass + lead);Pad 1 (Fantasia);Pad 2 (warm);Pad 3 (polysynth);Pad 4 (choir);Pad 5 (bowed);Pad 6 (metallic);Pad 7 (halo);Pad 8 (sweep);FX 1 (rain);FX 2 (soundtrack);FX 3 (crystal);FX 4 (atmosphere);FX 5 (brightness);FX 6 (goblins);FX 7 (echoes);FX 8 (sci-fi);Sitar;Banjo;Shamisen;Koto;Kalimba;Bagpipe;Fiddle;Shanai;Tinkle Bell;Agogo;Steel Drums;Woodblock;Taiko Drum;Melodic Tom;Synth Drum;Reverse Cymbal;Guitar Fret Noise;Breath Noise;Seashore;Bird Tweet;Telephone Ring;Helicopter;Applause;Gunshot".split(";");
function X(c,a,b){b===p&&(b=0);return c[a]?c[a].amount:b}Aa.prototype.start=function(){this.bufSrc.connect(this.gainMaster);this.gainMaster.connect(this.ctx.destination);this.bufSrc.start(0);this.masterVolume=16383;this.gainMaster.gain.value=this.baseVolume*(16383/16384)};Aa.prototype.stop=function(){this.bufSrc.disconnect(0);this.gainMaster.disconnect(0);this.compressor.disconnect(0)};var Ca=["Instrument","Vol","Pan","Bend","Range"];
function Da(c){var a=c.table=document.createElement("table"),b=document.createElement("thead"),d=document.createElement("tbody"),f,g,e,k;b.appendChild(Ea(Ca,u));for(e=0;16>e;++e){f=Ea(Ca.length+128,y);d.appendChild(f);g=f.querySelectorAll("td:nth-last-child(-n+128)");for(k=0;128>k;++k)g[k].addEventListener("mousedown",function(a,b,c){return function(d){d.preventDefault();a.drag=u;a.noteOn(b,c,127)}}(c,e,k)),g[k].addEventListener("mousemove",function(a,b,c){return function(d){d.preventDefault();a.drag&&
a.noteOn(b,c,127)}}(c,e,k)),g[k].addEventListener("mouseout",function(a,b,c){return function(d){d.preventDefault();a.noteOff(b,c,0)}}(c,e,k)),g[k].addEventListener("mouseup",function(a,b,c){return function(d){d.preventDefault();a.drag=y;a.noteOff(b,c,0)}}(c,e,k))}a.appendChild(b);a.appendChild(d);return a}
function Ea(c,a){var b=document.createElement("tr"),d,f=c instanceof Array,g,e=f?c.length:c;for(g=0;g<e;++g)d=document.createElement(a?"th":"td"),d.textContent=f&&c[g]!==p?c[g]:"",b.appendChild(d);return b}
Aa.prototype.noteOn=function(c,a){var b=this.bankSet[9===c?128:this.bank][this.channelInstrument[c]],d,f;this.table&&this.table.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child("+(Ca.length+a+1)+")").classList.add("note-on");b?(d=b[a])?(d.channel=c,d.key=a,d.panpot=this.channelPanpot[c],d.volume=this.channelVolume[c],d.pitchBend=this.channelPitchBend[c],d.pitchBendSensitivity=this.channelPitchBendSensitivity[c],f=new ba(this.ctx,this.gainMaster,d),f.noteOn(),this.currentNoteOn[c].push(f)):
I.console.warn("instrument not found: bank=%s instrument=%s channel=%s key=%s",9===c?128:this.bank,this.channelInstrument[c],c,a):I.console.warn("instrument not found: bank=%s instrument=%s channel=%s",9===c?128:this.bank,this.channelInstrument[c],c)};
Aa.prototype.noteOff=function(c,a){var b=this.bankSet[9===c?128:this.bank][this.channelInstrument[c]],d,f,g=this.currentNoteOn[c],e;this.table&&this.table.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child("+(a+Ca.length+1)+")").classList.remove("note-on");if(b){d=0;for(f=g.length;d<f;++d)e=g[d],e.key===a&&(e.noteOff(),g.splice(d,1),--d,--f)}};
function Ia(c,a,b){c.table&&(c.table.querySelector("tbody > tr:nth-child("+(a+1)+") > td:first-child").textContent=9===a?"[ RHYTHM TRACK ]":Ba[b]);9!==a&&(c.channelInstrument[a]=b)}function Ja(c,a,b){c.table&&(c.table.querySelector("tbody > tr:nth-child("+(a+1)+") > td:nth-child(2)").textContent=b);c.channelVolume[a]=b/127}function Ka(c,a,b){var d=b-64,d=d/(0>d?64:63);c.table&&(c.table.querySelector("tbody > tr:nth-child("+(a+1)+") > td:nth-child(3)").textContent=b);c.channelPanpot[a]=d}
Aa.prototype.pitchBend=function(c,a,b){var d,f,g,e=this.currentNoteOn[c];d=(a&127|(b&127)<<7)-8192;this.table&&(this.table.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child(4)").textContent=d);f=0;for(g=e.length;f<g;++f)ma(e[f],d);this.channelPitchBend[c]=d};Aa.prototype.pitchBendSensitivity=function(c,a){this.table&&(this.table.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child(5)").textContent=a);this.channelPitchBendSensitivity[c]=a};function Y(){this.RpnMsb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.RpnLsb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];window.addEventListener("DOMContentLoaded",function(){this.ready=u}.bind(this),y)}Y.prototype.setup=function(c){this.ready?this.load(c):window.addEventListener("DOMContentLoaded",function b(){window.removeEventListener("DOMContentLoaded",b,y);this.load(c)}.bind(this),y)};
Y.prototype.load=function(c){var a=new XMLHttpRequest;a.open("GET",c,u);a.responseType="arraybuffer";a.addEventListener("load",function(a){var c=a.target;this.onload(c.response);"function"===typeof this.loadCallback&&this.loadCallback(c.response)}.bind(this),y);a.send()};
Y.prototype.onload=function(c){var a,b,d,f,g=new Uint8Array(c),e=this.synth=new Aa(g),k=Da(e),v;e.parser=new pa(e.input);var r=e.parser;r.parse();var z=r.presetHeader,x=r.presetZone,E=[],J,A,B,t,w,D,C,S;w=0;for(D=z.length;w<D;++w){J=z[w].presetBagIndex;A=z[w+1]?z[w+1].presetBagIndex:x.length;B=[];C=J;for(S=A;C<S;++C){var s=za(x[C].presetGeneratorIndex,x[C+1]?x[C+1].presetGeneratorIndex:r.presetZoneGenerator.length,r.presetZoneGenerator);d=s.modgen;f=s.modgenInfo;var n=za(x[C].presetModulatorIndex,
x[C+1]?x[C+1].presetModulatorIndex:r.presetZoneModulator.length,r.presetZoneModulator);a=n.modgen;b=n.modgenInfo;B.push({generator:d,generatorSequence:f,modulator:a,modulatorSequence:b});t=d.instrument!==p?d.instrument.amount:a.instrument!==p?a.instrument.amount:0}E.push({name:z[w].presetName,info:B,header:z[w],instrument:t})}var ha,ia,T,Z,F=r.instrument,O=r.instrumentZone,ja=[],ca,da,P,G,Q,H,ka;G=0;for(Q=F.length;G<Q;++G){ca=F[G].instrumentBagIndex;da=F[G+1]?F[G+1].instrumentBagIndex:O.length;P=
[];H=ca;for(ka=da;H<ka;++H){var U=za(O[H].instrumentGeneratorIndex,O[H+1]?O[H+1].instrumentGeneratorIndex:r.instrumentZoneGenerator.length,r.instrumentZoneGenerator);T=U.modgen;Z=U.modgenInfo;var $=za(O[H].presetModulatorIndex,O[H+1]?O[H+1].instrumentModulatorIndex:r.instrumentZoneModulator.length,r.instrumentZoneModulator);ha=$.modgen;ia=$.modgenInfo;P.push({generator:T,generatorSequence:Z,modulator:ha,modulatorSequence:ia})}ja.push({name:F[G].instrumentName,info:P})}var K=[],ea,R,V,W,L,l,h,la;L=
0;for(l=E.length;L<l;++L)if(R=E[L],W=R.header.preset,V=ja[R.instrument],"EOI"!==V.name.replace(/\0*$/,"")){K[R.header.bank]===p&&(K[R.header.bank]=[]);ea=K[R.header.bank];ea[W]=[];ea[W].name=R.name;h=0;for(la=V.info.length;h<la;++h){var fa=r,Fa=ea[W],q=V.info[h].generator,M=p,qa=p,ra=p,sa=p,ta=p,Ga=p,ua=p,va=p,ga=p,Ha=p;if(!(q.keyRange===p||q.sampleID===p)){qa=X(q,"attackVolEnv");ra=X(q,"decayVolEnv");sa=X(q,"sustainVolEnv");ta=X(q,"releaseVolEnv");Ga=X(q,"coarseTune")+X(q,"fineTune")/100;ua=X(q,
"scaleTuning",100)/100;va=X(q,"freqVibLFO");ga=q.keyRange.lo;for(Ha=q.keyRange.hi;ga<=Ha;++ga)Fa[ga]||(M=fa.sampleHeader[X(q,"sampleID")],Fa[ga]={sample:new Int16Array((new Uint8Array(fa.input.subarray(fa.samplingData.offset+2*M.start,fa.samplingData.offset+2*M.end))).buffer),sampleRate:M.sampleRate,basePlaybackRate:Math.pow(Math.pow(2,1/12),(ga-X(q,"overridingRootKey",M.originalPitch)+Ga+M.pitchCorrection/100)*ua),modEnvToPitch:X(q,"modEnvToPitch")/100,scaleTuning:ua,start:32768*X(q,"startAddrsCoarseOffset")+
X(q,"startAddrsOffset"),end:32768*X(q,"endAddrsCoarseOffset")+X(q,"endAddrsOffset"),loopStart:M.startLoop-M.start+32768*X(q,"startloopAddrsCoarseOffset")+X(q,"startloopAddrsOffset"),loopEnd:M.endLoop-M.start+32768*X(q,"endloopAddrsCoarseOffset")+X(q,"endloopAddrsOffset"),attack:qa?Math.pow(2,qa/1200):0,decay:ra?Math.pow(2,ra/1200):0,sustain:sa?sa/1E3:0,release:ta?Math.pow(2,ta/1200):0,freqVibLFO:va?8.176*Math.pow(2,va/1200):p})}}}e.bankSet=K;for(v=0;16>v;++v)Ia(e,v,v),Ja(e,v,100),Ka(e,v,64),e.pitchBend(v,
0,64),e.pitchBendSensitivity(v,2);e.start();document.body.appendChild(k);window.addEventListener("message",this.onmessage.bind(this),y);window.opener?window.opener.postMessage("link,ready","*"):window.parent!==window&&window.parent.postMessage("link,ready","*")};Y.prototype.onmessage=function(c){var a=c.data.split(",");switch(a.shift()){case "midi":La(this,a.map(function(a){return parseInt(a,16)}));break;default:I.console.error("unknown message type")}};
Y.prototype.setLoadCallback=function(c){this.loadCallback=c};
function La(c,a){var b=a[0]&15,d=c.synth;switch(a[0]&240){case 128:d.noteOff(b,a[1],a[2]);break;case 144:0<a[2]?d.noteOn(b,a[1],a[2]):d.noteOff(b,a[1],0);break;case 176:switch(a[1]){case 6:switch(c.RpnMsb[b]){case 0:switch(c.RpnLsb[b]){case 0:d.pitchBendSensitivity(b,a[2])}}break;case 7:Ja(d,b,a[2]);break;case 10:Ka(d,b,a[2]);break;case 120:for(var f=d.currentNoteOn[b];0<f.length;)d.noteOff(b,f[0].key,0);break;case 121:d.pitchBend(b,0,64);break;case 100:c.RpnMsb[b]=a[2];break;case 101:c.RpnLsb[b]=
a[2]}break;case 192:Ia(d,b,a[1]);break;case 224:d.pitchBend(b,a[1],a[2]);break;case 240:switch(a[1]){case 127:switch(a[3]){case 4:switch(a[4]){case 1:var g=a[5]+(a[6]<<7);d.masterVolume=g;d.gainMaster.gain.value=d.baseVolume*(g/16384)}}}}};aa("SoundFont.WebMidiLink",Y);aa("SoundFont.WebMidiLink.prototype.setup",Y.prototype.setup);aa("SoundFont.WebMidiLink.prototype.setLoadCallback",Y.prototype.setLoadCallback);}).call(this);
